title: Potential Cryptominer Post-Exploitation Sequence
id: b2e5f1a9-4c3d-4e5f-9a8b-7c6d5e4f3a21
status: experimental
description: |
  Detects a typical post-exploitation sequence used by attackers in Linux environments. 
  The pattern includes system reconnaissance (CPU/Network), conflict checks for existing miners (ps/grep), and sanity checks for shell responsiveness (echo/cat).

  Reported by Team_D4rkn3ttz
  Detected by @wa__ri2
author: wa__ri2
date: 2026-02-14
references:
  - internal-honeypot-telemetry
logsource:
  product: linux
  category: honeypot
  service: cowrie

detection:
  selection_network:
    CommandLine|contains: 'ifconfig'
  selection_cpu:
    CommandLine|contains: '/proc/cpuinfo'
  selection_miner_check:
    CommandLine|contains|all:
      - 'ps'
      - 'grep'
      - '[Mm]iner'
  selection_specific_discovery:
    CommandLine|contains: 
      - 'locate D877F783D5D3EF8Cs'
      - '/ip cloud print'
  selection_sanity_check:
    CommandLine|contains: 'echo Hi | cat -n'

correlation:
  type: temporal
  rules:
    - selection_network
    - selection_cpu
    - selection_miner_check
    - selection_specific_discovery
    - selection_sanity_check
  group-by:
    - session
  timespan: 5m
  condition: 3 of selection_*

level: high
tags:
  - attack.t1016 # System Network Configuration Discovery
  - attack.t1082 # System Information Discovery
  - attack.t1057 # Process Discovery
  - attack.t1592 # Gather Victim Host Information