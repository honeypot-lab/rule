title: Standard - Execution and Trace Cleanup Actions
id: 2b9d3e4f-5a6b-4c7d-8e9f-0a1b2c3d4e5f
status: experimental
description: |
    Detects granting execution permissions, immediate shell execution, 
    and file deletion (cleanup) to evade forensics.
author: BISHOP1027
date: 2026-02-18
logsource:
    product: linux
    category: honeypot
    service: cowrie
detection:
    # prefer detecting chmod followed by immediate execution in same command or short chain
    selection_chmod_exec:
        - input|re: 'chmod\s+\+x\s+\S+\s*&&\s*\./\S+'
        - input|re: 'chmod\s+\+x\s+\S+\s*;\s*\./\S+'
        - input|re: 'chmod\s+\+x\s+\S+\s*&&\s*sh\s+\S+'
    selection_cleanup:
        - input|re: 'rm\s+-rf\s+\S+'
        - input|re: 'rm\s+-f\s+\S+'
    # additional lightweight execution indicators (for correlation with cleanup)
    selection_exec_simple:
        - input|re: '\./\S+'
        - input|re: 'sh\s+\S+'

    # flag if chmod+exec sequence OR cleanup commands occurring together with execution
    condition: selection_chmod_exec or (selection_cleanup and selection_exec_simple)
level: medium
tags:
    - attack.execution      # T1059.004
    - attack.defense_evasion # T1070.004 (Indicator Removal)